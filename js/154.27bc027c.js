"use strict";(self["webpackChunkhex_vue_project_week7"]=self["webpackChunkhex_vue_project_week7"]||[]).push([[154],{8154:function(e,t,a){a.r(t),a.d(t,{default:function(){return P}});var s=a(3396),l=a(9242),o=a(7139);const r={class:"container"},i=(0,s._)("h3",{class:"h3 text-center mt-4"},"購物車",-1),c={class:"text-end"},d=["disabled"],n={class:"table align-middle"},u=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th"),(0,s._)("th",null,"品名"),(0,s._)("th",{style:{width:"150px"}},"數量/單位"),(0,s._)("th",null,"單價")])],-1),m=["disabled","onClick"],h={class:"fas fa-spinner fa-pulse"},p=(0,s.Uk)(" x "),_={key:0,class:"text-success"},f={class:"input-group input-group-sm"},b={class:"input-group mb-3"},g=["onUpdate:modelValue","disabled","onChange"],v=["value"],y={class:"input-group-text",id:"basic-addon2"},x={class:"text-end"},k={class:"row justify-content-center"},w={key:0,class:"col-md-6"},C={class:"col-md-6 text-center"},$={key:0,class:"text-success"},D=(0,s._)("td",{colspan:"3",class:"text-end"},"總計",-1),V={class:"text-end"},q={key:0},U=(0,s._)("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),L={class:"text-end text-success"},W=(0,s._)("div",{class:"row justify-content-center"},[(0,s._)("p",{class:"h5 text-danger col-md-12 col-sm-6"},"大大大優惠!!"),(0,s._)("p",{class:"h6 col-md-12 col-sm-6 mb-5"},[(0,s.Uk)(" 輸入折扣碼 "),(0,s._)("b",{class:"text-success"},"big777"),(0,s.Uk)(" 即可享有77折優惠 ")])],-1),z={class:"row input-group"},I=(0,s._)("label",{for:"codeInput",class:"col-md-3 form-label text-center"},"折扣碼",-1),j={class:"my-5 row justify-content-center"},F={class:"mb-3"},A=(0,s._)("label",{for:"email",class:"form-label"},"Email",-1),E={class:"mb-3"},M=(0,s._)("label",{for:"name",class:"form-label"},"收件人姓名",-1),S={class:"mb-3"},H=(0,s._)("label",{for:"tel",class:"form-label"},"收件人電話",-1),K={class:"mb-3"},O=(0,s._)("label",{for:"address",class:"form-label"},"收件人地址",-1),Y={class:"mb-3"},N=(0,s._)("label",{for:"message",class:"form-label"},"留言",-1),R=(0,s._)("div",{class:"text-end"},[(0,s._)("button",{class:"btn btn-danger"},"送出訂單")],-1);function Z(e,t,a,Z,B,G){const J=(0,s.up)("Field"),P=(0,s.up)("ErrorMessage"),Q=(0,s.up)("Form");return(0,s.wg)(),(0,s.iD)("div",r,[i,(0,s._)("div",c,[(0,s._)("button",{class:"btn btn-outline-danger",disabled:""!==B.isLoading,type:"button",onClick:t[0]||(t[0]=(...e)=>G.clearAllCart&&G.clearAllCart(...e))}," 清空購物車 ",8,d)]),(0,s._)("table",n,[u,(0,s._)("tbody",null,[B.cartData.carts?((0,s.wg)(!0),(0,s.iD)(s.HY,{key:0},(0,s.Ko)(B.cartData.carts,(t=>((0,s.wg)(),(0,s.iD)("tr",{key:t.id},[(0,s._)("td",null,[(0,s._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:B.isLoading===t.id,onClick:e=>G.removeCartItem(t.id)},[(0,s.wy)((0,s._)("i",h,null,512),[[l.F8,B.isLoading===t.id]]),p],8,m)]),(0,s._)("td",null,[(0,s.Uk)((0,o.zw)(t.product.title)+" ",1),t.final_total!==t.total?((0,s.wg)(),(0,s.iD)("div",_," 已套用優惠券 ")):(0,s.kq)("",!0)]),(0,s._)("td",null,[(0,s._)("div",f,[(0,s._)("div",b,[(0,s.wy)((0,s._)("select",{id:"cartNum",class:"form-select","onUpdate:modelValue":e=>t.qty=e,disabled:B.isLoading===t.id,onChange:e=>G.updateCartItem(t)},[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(20,(e=>(0,s._)("option",{value:e,key:`${e}${t.id}`},(0,o.zw)(e),9,v))),64))],40,g),[[l.bM,t.qty]]),(0,s._)("span",y,(0,o.zw)(t.product.unit),1)])])]),(0,s._)("td",x,[(0,s._)("div",k,[t.final_total!==t.total?((0,s.wg)(),(0,s.iD)("div",w,[(0,s._)("del",null,"原價 : "+(0,o.zw)(e.$filters.currency(t.total)),1)])):(0,s.kq)("",!0),(0,s._)("div",C,[t.final_total!==t.total?((0,s.wg)(),(0,s.iD)("small",$,"折扣價：")):(0,s.kq)("",!0),(0,s.Uk)(" "+(0,o.zw)(e.$filters.currency(t.final_total)),1)])])])])))),128)):(0,s.kq)("",!0)]),(0,s._)("tfoot",null,[(0,s._)("tr",null,[D,(0,s._)("td",V,(0,o.zw)(e.$filters.currency(B.cartData.total)),1)]),B.cartData.final_total!==B.cartData.total?((0,s.wg)(),(0,s.iD)("tr",q,[U,(0,s._)("td",L,(0,o.zw)(e.$filters.currency(B.cartData.final_total)),1)])):(0,s.kq)("",!0)])]),W,(0,s._)("div",z,[I,(0,s.wy)((0,s._)("input",{type:"text",class:"col-md-3 mb-3 form-control",id:"codeInput","onUpdate:modelValue":t[1]||(t[1]=e=>B.code=e)},null,512),[[l.nr,B.code]]),(0,s._)("button",{type:"button",class:"col-md-3 mb-3 btn btn-outline-success",onClick:t[2]||(t[2]=(...e)=>G.useCoupon&&G.useCoupon(...e))}," 使用折扣碼 ")]),(0,s._)("div",j,[(0,s.Wm)(Q,{ref:"form",class:"col-md-6",onSubmit:G.createOrder},{default:(0,s.w5)((({errors:e})=>[(0,s._)("div",F,[A,(0,s.Wm)(J,{id:"email",name:"email",type:"email",class:(0,o.C_)(["form-control",{"is-invalid":e["email"]}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:B.form.user.email,"onUpdate:modelValue":t[3]||(t[3]=e=>B.form.user.email=e)},null,8,["class","modelValue"]),(0,s.Wm)(P,{name:"email",class:"invalid-feedback"})]),(0,s._)("div",E,[M,(0,s.Wm)(J,{id:"name",name:"姓名",type:"text",class:(0,o.C_)(["form-control",{"is-invalid":e["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:B.form.user.name,"onUpdate:modelValue":t[4]||(t[4]=e=>B.form.user.name=e)},null,8,["class","modelValue"]),(0,s.Wm)(P,{name:"姓名",class:"invalid-feedback"})]),(0,s._)("div",S,[H,(0,s.Wm)(J,{id:"tel",name:"電話",type:"tel",class:(0,o.C_)(["form-control",{"is-invalid":e["電話"]}]),placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:B.form.user.tel,"onUpdate:modelValue":t[5]||(t[5]=e=>B.form.user.tel=e)},null,8,["class","modelValue"]),(0,s.Wm)(P,{name:"電話",class:"invalid-feedback"})]),(0,s._)("div",K,[O,(0,s.Wm)(J,{id:"address",name:"地址",type:"text",class:(0,o.C_)(["form-control",{"is-invalid":e["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:B.form.user.address,"onUpdate:modelValue":t[6]||(t[6]=e=>B.form.user.address=e)},null,8,["class","modelValue"]),(0,s.Wm)(P,{name:"地址",class:"invalid-feedback"})]),(0,s._)("div",Y,[N,(0,s.wy)((0,s._)("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[7]||(t[7]=e=>B.form.message=e)},null,512),[[l.nr,B.form.message]])]),R])),_:1},8,["onSubmit"])])])}var B={data(){return{code:"",isLoading:"",isReady:"",qty:1,cartData:[],form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getCart(){const e="https://vue3-course-api.hexschool.io/v2/api/hyxfish27/cart";this.$http.get(e).then((e=>{this.cartData=e.data.data})).catch((e=>{alert(e.data.message)}))},updateCartItem(e){const t=`https://vue3-course-api.hexschool.io/v2/api/hyxfish27/cart/${e.id}`,a={product_id:e.id,qty:e.qty};this.$http.put(t,{data:a}).then((e=>{alert(e.data.message),this.getCart()})).catch((e=>{alert(e.data.message)}))},removeCartItem(e){const t=`https://vue3-course-api.hexschool.io/v2/api/hyxfish27/cart/${e}`;this.isLoading=e,this.$http.delete(t).then((e=>{alert(e.data.message),this.getCart(),this.isLoading=""})).catch((e=>{alert(e.data.message)}))},clearAllCart(){const e="https://vue3-course-api.hexschool.io/v2/api/hyxfish27/carts";this.isLoading="clear",this.$http.delete(e).then((e=>{alert(e.data.message),this.getCart(),this.isLoading=""})).catch((e=>{alert(e.data.message)}))},useCoupon(){const e=this.code,t="https://vue3-course-api.hexschool.io/v2/api/hyxfish27/coupon";this.$http.post(t,{data:{code:e}}).then((e=>{alert(e.data.message),this.getCart()})).catch((e=>{alert(e.data.message)}))},createOrder(){this.isLoading=!0;const e="https://vue3-course-api.hexschool.io/v2/api/hyxfish27/order",t=this.form;this.$http.post(e,{data:t}).then((e=>{this.$router.push(`/user/order/${e.data.orderId}`),this.$refs.form.resetForm(),this.isLoading=!1})).catch((e=>{this.isLoading=!1,this.$httpMessageState(e.response,"建立訂單")}))}},mounted(){this.getCart()}},G=a(89);const J=(0,G.Z)(B,[["render",Z]]);var P=J}}]);
//# sourceMappingURL=154.27bc027c.js.map